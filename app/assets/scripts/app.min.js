var App=function(){function t(){g(),e(),a(),o(),d(),l(),c(),s(),r(),p(),i(),n()}function e(){$("#remove").on("click",function(t){t.preventDefault()});var t={id:1,title:"This is a sample task",description:"Sample tasks are useful to get started",remote_url:"https://asana.com/12345/1234",assigned_to:"Jon Doe",status:"pending"};LocalStorage.get("appInitialized",!0)||(LocalStorage.set("taskCounter",1),LocalStorage.set("status",JSON.stringify([{key:"rejected",value:"Rejected"},{key:"pending",value:"Pending"},{key:"development",value:"Development"}])),LocalStorage.set("task-1",JSON.stringify(t)),LocalStorage.set("appInitialized",!0))}function a(){var t=JSON.parse(LocalStorage.get("status")),e=$("header ul"),a=$("#dashboard");t.map(function(t){var o=$("<li>"+t.value+"</li>");o.attr("data-id",t.key),e.append(o);var s=$("<div id="+t.key+" class="+t.key+"></div>");a.append(s)})}function o(){$("header li").on("dblclick",function(t){t.preventDefault();var e=$(this).attr("data-id");$("#change-status-modal").removeClass("hide"),$("#new_status").val($(this).text()),$("#change-status-modal").find("form").on("submit",function(t){t.preventDefault();var a=$("#new_status").val(),o=JSON.parse(LocalStorage.get("status"));o.map(function(t){t.key==e&&(t.value=a)}),$("header ul li[data-id="+e+"]").html(a),LocalStorage.set("status",JSON.stringify(o)),$(".close-modal").trigger("click")})})}function s(){var t=$("#task-card-template").html(),e=Handlebars.compile(t);$("#add-task").on("click",function(t){t.preventDefault(),$("#add-task-modal").removeClass("hide"),$("#add-task-modal").find("form").on("submit",function(t){t.preventDefault();for(var a={},o=$(this).serialize(),s=o.split("&"),i=0,n=s.length;i<n;i++){var r=s[i].split("=");a[r[0]]=unescape(r[1])}if(""!==a.description&&""!==a.title){var l=LocalStorage.get("taskCounter");a.id=++l,a.status="pending",LocalStorage.set("task-"+a.id,JSON.stringify(a)),LocalStorage.set("taskCounter",l);var c=e([a]);$("#dashboard #"+a.status).append(c),d(),$(".close-modal").trigger("click"),$(this).find("input[type=text], textarea").val("")}})})}function i(){$(document).on("dblclick",".card-details",function(t){t.stopPropagation(),$(this).find("p").attr("contenteditable","true").parents(".card").addClass("edit-mode")}),$(document).on("input",".card p",function(){var t=$(this).parents(".card").data("task-id"),e=$(this).data("field"),a=JSON.parse(LocalStorage.get("task-"+t));a[e]=$(this).text(),LocalStorage.set("task-"+t,JSON.stringify(a))})}function n(){$(document).on("dblclick",function(t){$(".card").removeClass("edit-mode").find("[contenteditable]").removeAttr("contenteditable")})}function r(){$(".close-modal").on("click",function(){$(".modal").addClass("hide")})}function d(){$(".card").draggable({handle:"h5",revert:!1,helper:function(t){var e=$(t.target).hasClass("ui-draggable")?$(t.target):$(t.target).closest(".ui-draggable");return e.clone().css({width:e.width()})},scroll:!1,cursor:"move",start:function(t,e){},stop:function(t,e){}})}function l(){var t={tolerance:"pointer",drop:function(t,e){var a=e.draggable,o=a.parent().attr("id"),s=$(this).attr("id"),i=a.data("task-id");if("remove"==$(this).attr("id"))a.remove(),LocalStorage.remove("task-"+i),$("#removed-task-notification").text("Task removed successfully").removeClass("hide"),setTimeout(function(){$("#removed-task-notification").text("").addClass("hide")},3e3);else if(o!=s){$(a).detach().removeAttr("style").appendTo(this);var n=JSON.parse(LocalStorage.get("task-"+i));n.status=s,LocalStorage.set("task-"+i,JSON.stringify(n))}$(this).removeClass("dragged-over")},over:function(t,e){$(this).addClass("dragged-over")},out:function(t,e){$(this).removeClass("dragged-over")}};$("#dashboard > div, #remove").droppable(t)}function c(){$(document).on("click",".expand-card",function(t){$(this).parent().parent().toggleClass("expanded"),t.preventDefault()})}function u(){var t=localStorage,e=[];for(var a in t)"task"==a.split("-")[0]&&e.push(JSON.parse(localStorage[a]));return e}function p(){for(var t=$("#task-card-template").html(),e=Handlebars.compile(t),a=JSON.parse(LocalStorage.get("status")),o=0,s=a.length;o<s;o++){var i=App.getAllNotes().filter(function(t){return t.status==a[o].key});if(i){var n=e(i);$("#dashboard #"+a[o].key).append(n),d()}}}function g(){JSON.parse(LocalStorage.get("showedTip"))||$("#tips").removeClass("hide").addClass("tips"),$("#tips").on("click",function(){$(this).addClass("hide"),LocalStorage.set("showedTip",!0)})}return{init:t,getAllNotes:u}}();App.init();